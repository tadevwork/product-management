<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Product Management</title>
    <script src="https://kit.webawesome.com/fbcff8dcf4bd47c6.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/htmx.org@1.9.1"></script>
    <link rel="stylesheet" th:href="@{/assets/base/base.css}">
    <script type="module" th:src="@{/assets/base/product.js}"></script>

</head>
<body hx-boost="true">
<header>
    <h1 style="text-align: center">Products Management</h1>
</header>
<main class="content-container">
    <wa-card>
        <h3 slot="header">Products Management</h3>
        <div slot="header-actions">
            <div class="wa-cluster">
                <wa-input id="search-input"
                          placeholder="Search by title..."
                          name="keyword"
                          hx-get="/products/search"
                          hx-trigger="keyup[key=='Enter'] from:#search-input"
                          hx-target="#product-section"
                          hx-swap="innerHTML">
                </wa-input>
                <wa-button appearance="filled-outlined" variant="brand"
                           hx-get="/products"
                           hx-target="#product-section"
                           hx-swap="innerHTML">
                    Products
                </wa-button>
                <wa-button id="create-product-btn" appearance="filled-outlined"
                           variant="success" type="button">
                    New Product
                </wa-button>
            </div>
        </div>
            <wa-scroller orientation="vertical" style="max-height: 70vh;" id="product-section">
                <table class="product-table" id="product-table">
                    <thead>
                    <tr>
                        <th>No</th>
                        <th>Title</th>
                        <th>Handle</th>
                        <th>Vendor</th>
                        <th>Type</th>
                        <th>Action</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="product, iter : ${products}">
                        <td th:text="${iter.index + 1}"></td>
                        <td th:text="${product.title}"></td>
                        <td th:text="${product.handle}"></td>
                        <td th:text="${product.vendor}"></td>
                        <td th:text="${product.productType}"></td>
                        <td>
                            <wa-button variant="danger" appearance="filled"
                                       th:hx-delete="@{/products/{id}(id=${product.id})}"
                                       hx-target="#product-section"
                                       hx-swap="innerHTML"
                                       hx-confirm="Are you sure you want to delete this product?">
                                Delete
                            </wa-button>
                        </td>

                    </tr>
                    </tbody>
                </table>
                <div th:if="${products  == null || products.size() == 0}">
                    <div class="empty-space wa-stack wa-align-items-center">
                        <h3>No Product Available</h3>
                    </div>
                </div>
            </wa-scroller>
    </wa-card>

    <wa-dialog label="New Product" class="dialog-create-product" style="--width: 50vw;">
        <form hx-post="/products" hx-target="#product-section" hx-swap="innerHTML">
            <wa-input id="title" label="Title" name="title" required></wa-input>
            <wa-input id="handle" label="Handle" name="handle" required></wa-input>
            <wa-input id="vendor" label="Vendor" name="vendor" required></wa-input>
            <wa-select required label="Type" id="productType" name="productType">
                <wa-option th:each="type : ${productTypes}"
                           th:value="${type}"
                           th:text="${type}">
                </wa-option>
            </wa-select>

            <!-- Variants (optional) -->
            <wa-details summary="Variants (optional)" appearance="filled-outlined">
                <div id="variants-container">
                    <div class="variant-block">
                        <wa-input label="Title" name="variants[0].title"></wa-input>
                        <wa-input label="Option 1" name="variants[0].option1"></wa-input>
                        <wa-input label="Option 2" name="variants[0].option2"></wa-input>
                        <wa-input label="Option 3" name="variants[0].option3"></wa-input>
                        <wa-input label="Sku" name="variants[0].sku"></wa-input>
                        <div class="wa-stack">
                            <wa-checkbox id="variants-0-requiresShipping" name="variants[0].requiresShipping" value="true"> Requires Shipping </wa-checkbox>
                            <wa-checkbox id="taxable0" name="variants[0].taxable" value="true"> Taxable </wa-checkbox>
                            <wa-checkbox id="available0" name="variants[0].available" value="true"> Available </wa-checkbox>
                        </div>
                        <wa-input label="Price" name="variants[0].price" type="number" step="0.01"></wa-input>
                        <wa-input label="Grams" name="variants[0].grams" type="number"></wa-input>
                    </div>
                </div>
                <wa-button appearance="filled-outlined" variant="brand" id="add-variant-btn">
                    Add Variant
                </wa-button>
            </wa-details>

            <wa-details summary="Images (optional)" appearance="filled-outlined">
                <div id="images-container" class="image-block">
                    <wa-input label="Image URL" name="images[0].src"></wa-input>
                </div>
                <wa-button appearance="filled-outlined" variant="brand" id="add-image-btn">
                    Add Image
                </wa-button>
            </wa-details>

            <div slot="footer" class="wa-stack wa-align-items-end">
                <div class="wa-cluster">
                    <wa-button type="submit" variant="brand">
                        Save
                    </wa-button>
                    <wa-button appearance="filled-outlined" variant="neutral" data-dialog="close">
                        Close
                    </wa-button>
                </div>
            </div>
        </form>
    </wa-dialog>
</main>
</body>
</html> 